generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Employee {
  id          Int      @id @default(autoincrement())
  employeeId  String   @unique @map("employee_id")
  name        String
  department  String
  section     String?
  position    String?
  plant       String?
  nationality String   @default("Thai")
  isActive    Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")
  
  winner      Winner?

  @@map("employees")
}

model DrawSettings {
  id        Int      @id @default(autoincrement())
  keyName   String   @unique @map("key_name")
  valueJson Json     @map("value_json")
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at")

  @@map("draw_settings")
}

model Winner {
  id              Int      @id @default(autoincrement())
  employeeId      String   @unique @map("employee_id")
  employee        Employee @relation(fields: [employeeId], references: [employeeId])
  drawRoundNumber Int      @map("draw_round_number")
  wonAt           DateTime @default(now()) @map("won_at")
  prizeAmount     Decimal  @default(10000.00) @map("prize_amount") @db.Decimal(10, 2)
  status          String   @default("confirmed") // 'confirmed', 'rejected'

  @@map("winners")
}

model AdminUser {
  id           Int      @id @default(autoincrement())
  username     String   @unique
  passwordHash String   @map("password_hash")
  role         String   @default("admin")
  createdAt    DateTime @default(now()) @map("created_at")

  @@map("admin_users")
}

model AuditLog {
  id          Int      @id @default(autoincrement())
  action      String
  details     String?
  performedBy String?  @map("performed_by")
  createdAt   DateTime @default(now()) @map("created_at")

  @@map("audit_logs")
}
